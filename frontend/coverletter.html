<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover"/>
  <meta name="color-scheme" content="dark light"/>
  <meta name="theme-color" content="#0B1220"/>
  <title>Cover Letter · HIREX</title>
  <meta name="description" content="Generate a JD-optimized, humanized cover letter using stored job description and LaTeX resume."/>
  <meta name="author" content="Sri Akash Kadali"/>
  <meta property="og:title" content="Cover Letter · HIREX — Cover Letter Generator"/>
  <meta property="og:type" content="website"/>

  <meta http-equiv="Content-Security-Policy"
        content="
          default-src 'self' blob: data:;
          img-src 'self' data: blob:;
          style-src 'self' 'unsafe-inline' https://fonts.googleapis.com;
          font-src 'self' data: https://fonts.gstatic.com;
          script-src 'self' 'unsafe-inline' 'unsafe-eval' 'wasm-unsafe-eval';
          connect-src 'self' blob: data: https:
                       http://127.0.0.1:8000 ws://127.0.0.1:8000
                       http://0.0.0.0:8000   ws://0.0.0.0:8000
                       https://api.openai.com;
          frame-src 'self' blob: data: about:;
          child-src 'self' blob:;
          worker-src 'self' blob:;
          media-src 'self' blob: data:;
          object-src 'none';
          base-uri 'self';
          frame-ancestors 'self';
        "/>

  <link rel="icon" type="image/png" href="/static/assets/favicon.png"/>

  <!-- Google Sans + JetBrains Mono -->
  <link rel="preconnect" href="https://fonts.googleapis.com"/>
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin/>
  <link href="https://fonts.googleapis.com/css2?family=Google+Sans:wght@400;500;600;700&family=JetBrains+Mono:wght@400;500;700&display=swap" rel="stylesheet"/>

  <link rel="stylesheet" href="/static/css/animations.css?v=1.0.0"/>

<style>
:root{
  /* Surfaces */
  --bg0:#0B1220;
  --bg1:#0E1629;

  /* Text */
  --text:#EAF0FF;
  --muted:rgba(234,240,255,.72);
  --dim:rgba(234,240,255,.42);

  /* Accents */
  --accent:#7AA7FF;
  --ok:#34D399;
  --warn:#FBBF24;
  --danger:#FB7185;

  /* Lines + shadows */
  --line:rgba(255,255,255,.10);
  --line2:rgba(122,167,255,.18);
  --shadow:0 18px 50px rgba(0,0,0,.45);
  --shadow2:0 10px 26px rgba(0,0,0,.32);

  /* Type */
  --ui:"Google Sans",system-ui,-apple-system,"Segoe UI",Roboto,Arial,sans-serif;
  --mono:"JetBrains Mono",ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,monospace;

  /* Layout */
  --sidebar:268px;
  --topbar:52px;

  /* Radius */
  --r:16px;
  --r2:14px;
}

*,*::before,*::after{box-sizing:border-box;margin:0;padding:0;}
html{scroll-behavior:smooth;}
::selection{background:rgba(122,167,255,.35);color:#fff;}

body{
  font-family:var(--ui);
  background:
    radial-gradient(900px 520px at 20% -10%, rgba(122,167,255,.18), transparent 60%),
    radial-gradient(900px 520px at 85% 22%, rgba(185,199,255,.10), transparent 60%),
    radial-gradient(700px 500px at 65% 110%, rgba(52,211,153,.08), transparent 60%),
    linear-gradient(180deg, var(--bg0), var(--bg1));
  color:var(--text);
  font-size:14px;
  line-height:1.55;
  overflow-x:hidden;
  min-height:100vh;
}

/* Subtle noise */
.grain{
  position:fixed;inset:0;z-index:1;pointer-events:none;opacity:.028;
  background-image:url("data:image/svg+xml,%3Csvg viewBox='0 0 256 256' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='n'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.85' numOctaves='3' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23n)'/%3E%3C/svg%3E");
  background-size:220px 220px;
}

/* Ambient blobs */
.ambient{position:fixed;pointer-events:none;z-index:0;border-radius:50%;filter:blur(120px);opacity:.9;}
.amb-1{
  width:520px;height:520px;top:-220px;left:calc(var(--sidebar) - 120px);
  background:radial-gradient(circle,rgba(122,167,255,.26),transparent 70%);
  animation:drift 26s ease-in-out infinite alternate;
}
.amb-2{
  width:520px;height:520px;bottom:-220px;right:4%;
  background:radial-gradient(circle,rgba(52,211,153,.14),transparent 72%);
  animation:drift 30s ease-in-out infinite alternate-reverse;
}
@keyframes drift{from{transform:translate(0,0);}to{transform:translate(30px,34px);}}

/* ── TOPBAR ── */
.topbar{
  position:fixed;top:0;left:var(--sidebar);right:0;height:var(--topbar);
  z-index:40;
  background:rgba(15,22,41,.72);
  border-bottom:1px solid var(--line);
  display:flex;align-items:center;justify-content:space-between;
  padding:0 1.25rem;
  backdrop-filter:blur(18px);
  -webkit-backdrop-filter:blur(18px);
}
.topbar-left,.topbar-right{display:flex;align-items:center;gap:1rem;}
.sys-online{
  display:flex;align-items:center;gap:.5rem;
  font-size:12px;font-weight:600;color:var(--muted);
}
.sys-online::before{
  content:"";width:8px;height:8px;border-radius:999px;
  background:var(--ok);
  box-shadow:0 0 0 4px rgba(52,211,153,.10);
}
.topbar-tag{
  font-size:12px;color:var(--dim);
  display:flex;align-items:center;gap:.35rem;
}
.topbar-tag b{color:var(--muted);font-weight:600;}
#sys-clock{font-variant-numeric:tabular-nums;font-size:12px;color:var(--muted);}

/* ── SIDEBAR ── */
.sidebar{
  position:fixed;top:0;left:0;width:var(--sidebar);height:100vh;
  z-index:50;
  background:rgba(15,22,41,.78);
  border-right:1px solid var(--line);
  display:flex;flex-direction:column;
  overflow:hidden;
  backdrop-filter:blur(18px);
  -webkit-backdrop-filter:blur(18px);
}
.sidebar::after{
  content:"";position:absolute;inset:0;pointer-events:none;
  background:
    linear-gradient(180deg, rgba(255,255,255,.06), transparent 30%),
    radial-gradient(800px 380px at 20% 0%, rgba(122,167,255,.10), transparent 60%);
  opacity:.8;
}
.brand{
  position:relative;z-index:2;
  padding:1.15rem 1.1rem 1rem;
  border-bottom:1px solid var(--line);
  display:flex;flex-direction:column;gap:.5rem;
}
.brand-row{display:flex;align-items:center;gap:.8rem;}
.brand-logo{width:44px;height:44px;flex-shrink:0;border-radius:14px;overflow:hidden;}
.brand-logo img{
  width:44px;height:44px;object-fit:contain;
  background:rgba(255,255,255,.06);
  border:1px solid rgba(255,255,255,.08);
  border-radius:14px;
}
.brand-wordmark{display:flex;flex-direction:column;gap:.08rem;}
.brand-name{font-size:16px;font-weight:700;letter-spacing:.06em;color:var(--text);}
.brand-tagline{font-size:12px;color:var(--dim);}
.brand-sysinfo{display:flex;gap:.45rem;flex-wrap:wrap;margin-top:.15rem;}
.sys-badge{
  font-family:var(--mono);
  font-size:11px;
  color:rgba(234,240,255,.75);
  border:1px solid rgba(255,255,255,.12);
  border-radius:999px;
  padding:.18em .65em;
  background:rgba(255,255,255,.05);
}

.vnav{list-style:none;padding:.75rem .6rem;flex:1;overflow-y:auto;position:relative;z-index:2;}
.vnav::-webkit-scrollbar{width:6px;}
.vnav::-webkit-scrollbar-thumb{background:rgba(255,255,255,.14);border-radius:999px;}
.nav-group-label{
  font-size:11px;font-weight:700;letter-spacing:.10em;text-transform:uppercase;
  color:rgba(234,240,255,.42);padding:.75rem .7rem .35rem;
}
.vnav a{
  display:flex;align-items:center;gap:.7rem;
  color:rgba(234,240,255,.72);
  text-decoration:none;
  font-size:13px;font-weight:600;
  padding:.62rem .75rem;
  border-radius:12px;border:1px solid transparent;
  margin-bottom:.2rem;
  transition:background .15s,border-color .15s,transform .12s,color .15s;
  position:relative;
}
.vnav a .nav-ico{width:22px;text-align:center;opacity:.7;font-size:.92rem;}
.vnav a:hover{
  background:rgba(255,255,255,.06);
  border-color:rgba(255,255,255,.10);
  transform:translateY(-1px);
  color:var(--text);
}
.vnav a.active-link{
  background:linear-gradient(90deg, rgba(122,167,255,.22), rgba(255,255,255,.06));
  border-color:rgba(122,167,255,.25);
  color:var(--text);
}

.sidebar-foot{
  position:relative;z-index:2;
  padding:.9rem;border-top:1px solid var(--line);
  display:flex;flex-direction:column;gap:.55rem;
}
.btn-exec{
  width:100%;
  display:flex;align-items:center;justify-content:center;gap:.5rem;
  background:linear-gradient(180deg, rgba(122,167,255,.22), rgba(122,167,255,.14));
  border:1px solid rgba(122,167,255,.28);
  color:var(--text);
  font-family:var(--ui);
  font-size:12px;font-weight:700;letter-spacing:.06em;
  padding:.72rem .9rem;border-radius:12px;cursor:pointer;
  transition:transform .12s,box-shadow .2s,background .2s,border-color .2s;
  box-shadow:0 10px 22px rgba(0,0,0,.20);
}
.btn-exec:hover{
  transform:translateY(-1px);
  box-shadow:0 0 0 4px rgba(122,167,255,.10), 0 14px 32px rgba(0,0,0,.26);
}

.btn-kill{
  width:100%;
  display:flex;align-items:center;justify-content:center;gap:.5rem;
  background:rgba(251,113,133,.10);
  border:1px solid rgba(251,113,133,.22);
  color:rgba(251,113,133,.92);
  font-family:var(--ui);
  font-size:12px;font-weight:800;letter-spacing:.06em;
  padding:.7rem .9rem;border-radius:12px;cursor:pointer;
  transition:transform .12s,box-shadow .2s,background .2s,border-color .2s;
}
.btn-kill:hover{transform:translateY(-1px);box-shadow:0 0 0 4px rgba(251,113,133,.10);}
.btn-kill:disabled{opacity:.45;cursor:not-allowed;transform:none;}

/* ── HAMBURGER ── */
.hamburger{
  display:none;position:fixed;top:12px;left:12px;z-index:60;
  background:rgba(15,22,41,.72);
  border:1px solid var(--line);
  color:var(--text);
  font-size:1rem;padding:.46rem .66rem;border-radius:12px;
  cursor:pointer;backdrop-filter:blur(18px);-webkit-backdrop-filter:blur(18px);
}
@media(max-width:700px){
  .hamburger{display:block;}
  .sidebar{left:-100%;width:82%;transition:left .28s ease;}
  body.nav-open .sidebar{left:0;}
  main.console,.topbar,footer{margin-left:0!important;left:0!important;}
}

/* ── MAIN ── */
main.console{
  margin-left:var(--sidebar);
  padding:calc(var(--topbar) + 2.2rem) 2.75rem 5rem;
  position:relative;z-index:2;
  display:flex;flex-direction:column;align-items:center;
  min-height:100vh;
}

@keyframes rise{from{opacity:0;transform:translateY(10px);}to{opacity:1;transform:translateY(0);}}

/* Page header */
.page-head{
  width:100%;max-width:960px;
  display:flex;align-items:flex-start;justify-content:space-between;
  margin-bottom:1.6rem;
  gap:1rem;
  animation:rise .55s ease both;
}
.page-head-text{display:flex;flex-direction:column;gap:.6rem;}
.page-pre{
  font-family:var(--mono);
  font-size:12px;
  letter-spacing:.10em;
  text-transform:uppercase;
  color:rgba(234,240,255,.62);
}
h1.page-title{
  font-size:40px;
  letter-spacing:-.02em;
  line-height:1.05;
  color:var(--text);
}
h1.page-title span{
  display:block;
  font-size:14px;
  font-weight:600;
  letter-spacing:0;
  color:rgba(234,240,255,.70);
  margin-top:.45rem;
}
.page-desc{
  font-size:14px;
  color:rgba(234,240,255,.72);
  line-height:1.6;
  max-width:520px;
}

/* Status badge */
.status-pill{
  display:flex;align-items:center;gap:.5rem;
  border:1px solid rgba(255,255,255,.12);
  border-radius:999px;
  padding:.42rem .85rem;
  background:rgba(255,255,255,.05);
  font-family:var(--ui);
  font-size:12px;
  color:rgba(234,240,255,.72);
  white-space:nowrap;flex-shrink:0;height:fit-content;
  margin-top:.25rem;
}
.status-pill-dot{
  width:8px;height:8px;border-radius:999px;
  background:var(--warn);
  box-shadow:0 0 0 4px rgba(251,191,36,.10);
}
.status-pill.ready .status-pill-dot{background:var(--ok);box-shadow:0 0 0 4px rgba(52,211,153,.10);}
.status-pill.error .status-pill-dot{background:var(--danger);box-shadow:0 0 0 4px rgba(251,113,133,.10);}

/* ── PANELS ── */
.op-grid{
  width:100%;max-width:960px;
  display:grid;grid-template-columns:1fr 1fr;
  gap:1rem;margin-bottom:1rem;
  animation:rise .6s .06s ease both;
}

/* Generic panel */
.op-panel{
  background:rgba(255,255,255,.04);
  border:1px solid rgba(255,255,255,.10);
  border-radius:18px;
  backdrop-filter:blur(18px);
  -webkit-backdrop-filter:blur(18px);
  overflow:hidden;
  position:relative;
  box-shadow:0 10px 30px rgba(0,0,0,.20);
  transition:transform .15s,box-shadow .2s,border-color .2s,background .2s;
}
.op-panel:hover{
  transform:translateY(-2px);
  border-color:rgba(122,167,255,.16);
  background:rgba(255,255,255,.05);
  box-shadow:0 18px 44px rgba(0,0,0,.28);
}

/* disable bracket corners from old theme */
.op-panel.bracketed::before,.op-panel.bracketed::after,
.op-panel.bracketed .bc-bl,.op-panel.bracketed .bc-br{display:none!important;}

.panel-hd{
  display:flex;align-items:center;justify-content:space-between;
  padding:.85rem 1.05rem;
  background:rgba(255,255,255,.035);
  border-bottom:1px solid rgba(255,255,255,.08);
}
.panel-id{
  font-family:var(--ui);
  font-size:13px;
  font-weight:800;
  color:rgba(234,240,255,.86);
}
.panel-id::before{display:none!important;}
.panel-meta{
  font-family:var(--mono);
  font-size:11px;
  letter-spacing:.08em;
  color:rgba(234,240,255,.45);
  display:flex;gap:.8rem;
}
.panel-meta em{color:rgba(234,240,255,.65);font-style:normal;}

.panel-body{padding:1rem 1.05rem 1.05rem;}

/* ── SELECT DROPDOWNS ── */
.field{display:flex;flex-direction:column;gap:.5rem;}
.f-label{
  font-family:var(--ui);
  font-size:12px;
  font-weight:700;
  color:rgba(234,240,255,.72);
}
.f-label::after{display:none!important;}

select{
  width:100%;
  background:rgba(255,255,255,.05);
  color:rgba(234,240,255,.90);
  border:1px solid rgba(255,255,255,.12);
  border-radius:12px;
  padding:.8rem .95rem;
  font-family:var(--ui);
  font-size:14px;
  appearance:none;
  outline:none;
  cursor:pointer;
  transition:border-color .2s,box-shadow .2s,background .2s;
}
select:focus{
  border-color:rgba(122,167,255,.30);
  box-shadow:0 0 0 4px rgba(122,167,255,.12);
  background:rgba(255,255,255,.06);
}
option{background:#0C1426;color:rgba(234,240,255,.92);}

/* ── PARAMS PANEL ── */
.params-row{display:grid;grid-template-columns:1fr 1fr;gap:1rem;}
@media(max-width:600px){.params-row{grid-template-columns:1fr;}}

/* ── ACTION ROW ── */
.action-panel{
  width:100%;max-width:960px;
  background:rgba(255,255,255,.04);
  border:1px solid rgba(255,255,255,.10);
  border-radius:18px;
  padding:1rem 1.05rem;
  display:flex;align-items:center;gap:.8rem;flex-wrap:wrap;
  margin-bottom:1rem;
  box-shadow:0 10px 30px rgba(0,0,0,.20);
  animation:rise .6s .08s ease both;
}

.btn-primary,.btn-secondary,.btn-amber,.btn-danger{
  display:flex;align-items:center;gap:.45rem;
  font-family:var(--ui);
  font-size:12px;
  font-weight:800;
  letter-spacing:.06em;
  padding:.78rem 1.05rem;
  border-radius:12px;
  cursor:pointer;
  transition:transform .12s,box-shadow .2s,background .2s,border-color .2s;
}
.btn-primary{
  background:linear-gradient(180deg, rgba(122,167,255,.36), rgba(122,167,255,.20));
  border:1px solid rgba(122,167,255,.34);
  color:var(--text);
  box-shadow:0 14px 34px rgba(0,0,0,.25);
}
.btn-primary::before{display:none!important;}
.btn-primary:hover{transform:translateY(-1px);box-shadow:0 0 0 4px rgba(122,167,255,.12), 0 18px 45px rgba(0,0,0,.32);}
.btn-primary:disabled{opacity:.5;cursor:not-allowed;box-shadow:none;}

.btn-secondary{
  background:rgba(255,255,255,.05);
  border:1px solid rgba(255,255,255,.12);
  color:rgba(234,240,255,.78);
}
.btn-secondary:hover{transform:translateY(-1px);background:rgba(255,255,255,.07);border-color:rgba(255,255,255,.16);}
.btn-secondary:disabled{opacity:.5;cursor:not-allowed;}

.btn-amber{
  background:rgba(251,191,36,.10);
  border:1px solid rgba(251,191,36,.22);
  color:rgba(251,191,36,.92);
}
.btn-amber:hover{transform:translateY(-1px);box-shadow:0 0 0 4px rgba(251,191,36,.10);}

.btn-danger{
  background:rgba(251,113,133,.10);
  border:1px solid rgba(251,113,133,.22);
  color:rgba(251,113,133,.92);
}
.btn-danger:hover{transform:translateY(-1px);box-shadow:0 0 0 4px rgba(251,113,133,.10);}

/* ── OUTPUT PANEL ── */
.output-panel{
  width:100%;max-width:960px;
  background:rgba(255,255,255,.04);
  border:1px solid rgba(255,255,255,.10);
  border-radius:18px;
  overflow:hidden;
  box-shadow:0 10px 30px rgba(0,0,0,.20);
  animation:rise .65s .1s ease both;
}

/* Tabs */
.tab-bar{
  display:flex;align-items:center;
  border-bottom:1px solid rgba(255,255,255,.08);
  background:rgba(255,255,255,.035);
  padding:.55rem .75rem;
  gap:.4rem;
  overflow-x:auto;
}
.tab-bar::-webkit-scrollbar{height:8px;}
.tab-bar::-webkit-scrollbar-thumb{background:rgba(255,255,255,.14);border-radius:999px;}

.term-dots{display:flex;gap:.35rem;margin-right:.6rem;flex-shrink:0;}
.term-dot{width:10px;height:10px;border-radius:999px;}
.term-dot.red{background:#ff5f57;box-shadow:0 0 0 4px rgba(255,95,87,.10);}
.term-dot.amb{background:var(--warn);box-shadow:0 0 0 4px rgba(251,191,36,.10);}
.term-dot.grn{background:var(--ok);box-shadow:0 0 0 4px rgba(52,211,153,.10);}

.tab{
  display:flex;align-items:center;gap:.4rem;
  font-family:var(--ui);
  font-size:12px;
  font-weight:800;
  letter-spacing:.06em;
  color:rgba(234,240,255,.72);
  background:transparent;
  border:1px solid transparent;
  border-radius:12px;
  padding:.55rem .85rem;
  cursor:pointer;
  transition:background .15s,border-color .15s,transform .12s,color .15s;
  white-space:nowrap;
}
.tab:hover{transform:translateY(-1px);background:rgba(255,255,255,.05);border-color:rgba(255,255,255,.10);color:rgba(234,240,255,.86);}
.tab.active{
  background:linear-gradient(180deg, rgba(122,167,255,.22), rgba(122,167,255,.12));
  border-color:rgba(122,167,255,.22);
  color:rgba(234,240,255,.92);
}

/* Toolbar strip inside output */
.output-toolbar{
  display:flex;gap:.5rem;padding:.85rem 1rem;
  border-bottom:1px solid rgba(255,255,255,.08);
  flex-wrap:wrap;
  background:rgba(255,255,255,.02);
}

.pane{display:none;height:68vh;}
.pane.active{display:block;}

.pane pre{
  margin:0;
  padding:1rem 1.05rem 1.1rem;
  height:100%;
  overflow:auto;
  white-space:pre-wrap;
  word-break:break-word;
  font-family:var(--mono);
  font-size:12.5px;
  color:rgba(234,240,255,.86);
  line-height:1.7;
}
.pane pre::-webkit-scrollbar{width:8px;height:8px;}
.pane pre::-webkit-scrollbar-thumb{background:rgba(255,255,255,.14);border-radius:999px;}

.pdf-frame{width:100%;height:100%;border:none;background:#0A0F1C;}

/* Toast */
#toast{
  position:fixed;left:50%;transform:translateX(-50%);bottom:18px;
  background:rgba(15,22,41,.85);
  border:1px solid rgba(255,255,255,.12);
  color:rgba(234,240,255,.86);
  padding:.7rem 1.05rem;
  border-radius:12px;
  display:none;z-index:9999;
  font-family:var(--ui);font-size:13px;font-weight:700;
  box-shadow:0 18px 44px rgba(0,0,0,.28);
}

/* FAB */
.shutdown-fab{
  position:fixed;right:18px;bottom:18px;z-index:40;
  width:44px;height:44px;border-radius:14px;
  background:rgba(251,113,133,.10);
  border:1px solid rgba(251,113,133,.22);
  color:rgba(251,113,133,.92);
  display:flex;align-items:center;justify-content:center;
  font-size:1rem;
  cursor:pointer;
  transition:transform .12s,box-shadow .2s,background .2s,border-color .2s;
}
.shutdown-fab:hover{transform:translateY(-1px);box-shadow:0 0 0 4px rgba(251,113,133,.10), 0 18px 44px rgba(0,0,0,.28);}
.shutdown-fab:disabled{opacity:.45;cursor:not-allowed;transform:none;}

/* Footer */
footer{
  margin-left:var(--sidebar);
  padding:1rem 2rem;
  border-top:1px solid rgba(255,255,255,.10);
  display:flex;align-items:center;justify-content:space-between;
  flex-wrap:wrap;gap:.5rem;
  font-size:12px;color:rgba(234,240,255,.55);
  background:rgba(15,22,41,.65);
  backdrop-filter:blur(18px);
  -webkit-backdrop-filter:blur(18px);
}
footer b{color:rgba(234,240,255,.78);}
.ver-tag{
  border:1px solid rgba(255,255,255,.12);
  background:rgba(255,255,255,.05);
  color:rgba(234,240,255,.75);
  padding:.25em .75em;border-radius:999px;
  font-family:var(--mono);font-size:11px;
}

/* Responsive */
@media(max-width:900px){
  main.console{padding-left:1.75rem;padding-right:1.75rem;}
  .op-grid{grid-template-columns:1fr;}
  .page-head{flex-direction:column;}
}
@media(max-width:600px){
  main.console{padding-left:1.1rem;padding-right:1.1rem;}
  .action-panel{flex-direction:column;align-items:flex-start;}
}
</style>
</head>

<body class="glass-page">

<div class="grain" aria-hidden="true"></div>
<div class="ambient amb-1" aria-hidden="true"></div>
<div class="ambient amb-2" aria-hidden="true"></div>

<button id="nav-toggle" class="hamburger" aria-label="Toggle navigation" aria-controls="sidebar" aria-expanded="false">☰</button>

<aside class="sidebar" id="sidebar" role="navigation" aria-label="Primary">
  <div class="brand">
    <div class="brand-row">
      <div class="brand-logo">
        <img src="/static/assets/logo.png" alt="HIREX" loading="lazy"/>
      </div>
      <div class="brand-wordmark">
        <span class="brand-name">HIREX</span>
        <span class="brand-tagline">AI Career Ops System</span>
      </div>
    </div>
    <div class="brand-sysinfo">
      <span class="sys-badge">v1.0.0</span>
      <span class="sys-badge">GPT-4o</span>
      <span class="sys-badge">ONLINE</span>
    </div>
  </div>

  <ul class="vnav">
    <li class="nav-group-label">Core</li>
    <li><a href="/index.html"><span class="nav-ico">⬡</span> HIREX</a></li>
    <li><a href="/preview.html"><span class="nav-ico">◧</span> Preview</a></li>
    <li><a href="/coverletter.html" class="active-link" aria-current="page"><span class="nav-ico">◈</span> Cover Letter</a></li>

    <li class="nav-group-label">Intelligence</li>
    <li><a href="/talk.html"><span class="nav-ico">◎</span> Talk to HIREX</a></li>
    <li><a href="/mastermind.html"><span class="nav-ico">◉</span> MasterMind</a></li>
    <li><a href="/superhuman.html"><span class="nav-ico">◈</span> SuperHuman</a></li>

    <li class="nav-group-label">Analytics</li>
    <li><a href="/dashboard.html"><span class="nav-ico">▦</span> Dashboard</a></li>
    <li><a href="/genie.html"><span class="nav-ico">◐</span> Genie</a></li>
  </ul>

  <div class="sidebar-foot">
    <button class="btn-exec" type="button" id="sidebar-gen-btn">
      <span>Generate cover letter</span>
    </button>
    <button id="shutdown-btn" class="btn-kill" type="button">⏻ Kill server</button>
  </div>
</aside>

<div class="topbar" role="status">
  <div class="topbar-left">
    <span class="sys-online">Online</span>
    <span class="topbar-tag">Module <b>Cover letter</b></span>
    <span class="topbar-tag">Engine <b>v1.0.0</b></span>
  </div>
  <div class="topbar-right">
    <span class="topbar-tag">Session <b id="session-id">—</b></span>
    <span id="sys-clock">—</span>
  </div>
</div>

<main id="content" class="console" role="main">

  <div class="page-head" style="width:100%;max-width:960px;">
    <div class="page-head-text">
      <div class="page-pre">Cover letter module</div>
      <h1 class="page-title">
        Cover letter
        <span>Generate a targeted letter from your saved JD and resume</span>
      </h1>
      <p class="page-desc">
        Select a stored JD + resume pair, choose tone and length,
        then generate a cover letter compiled to PDF.
      </p>
    </div>
    <div class="status-pill" id="status-pill" aria-live="polite">
      <div class="status-pill-dot"></div>
      <span id="meta_badge">Idle</span>
    </div>
  </div>

  <div class="op-grid">

    <div class="op-panel bracketed">
      <div class="bc-bl"></div><div class="bc-br"></div>
      <div class="panel-hd">
        <span class="panel-id">Source</span>
        <div class="panel-meta"><em>Context store</em></div>
      </div>
      <div class="panel-body">
        <div class="field">
          <label class="f-label" for="historySelect">JD + resume pair</label>
          <select id="historySelect" aria-label="Previous JD and Resume pairs">
            <option disabled selected>Loading jobs...</option>
          </select>
        </div>
      </div>
    </div>

    <div class="op-panel bracketed">
      <div class="bc-bl"></div><div class="bc-br"></div>
      <div class="panel-hd">
        <span class="panel-id">History</span>
        <div class="panel-meta"><em>Saved letters</em></div>
      </div>
      <div class="panel-body">
        <div class="field">
          <label class="f-label" for="clHistorySelect">Cover letter history</label>
          <select id="clHistorySelect" aria-label="Previously generated cover letters">
            <option disabled selected>No saved cover letters</option>
          </select>
        </div>
      </div>
    </div>

  </div>

  <div style="width:100%;max-width:960px;margin-bottom:1rem;animation:rise .6s .08s ease both;">
    <div class="op-panel bracketed">
      <div class="bc-bl"></div><div class="bc-br"></div>
      <div class="panel-hd">
        <span class="panel-id">Parameters</span>
        <div class="panel-meta"><em>Tone and length</em></div>
      </div>
      <div class="panel-body">
        <div class="params-row">
          <div class="field">
            <label class="f-label" for="toneSelect">Tone</label>
            <select id="toneSelect" aria-label="Cover letter tone">
              <option value="balanced" selected>Balanced (recommended)</option>
              <option value="warm">Warm</option>
              <option value="formal">Formal</option>
              <option value="confident">Confident</option>
              <option value="concise">Concise</option>
            </select>
          </div>
          <div class="field">
            <label class="f-label" for="lengthSelect">Length</label>
            <select id="lengthSelect" aria-label="Cover letter length">
              <option value="short">Short (~120–180 words)</option>
              <option value="standard" selected>Standard (~180–280 words)</option>
              <option value="long">Long (~300–400 words)</option>
            </select>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="action-panel">
    <button class="btn-primary" id="generate_btn" type="button">
      <span>Generate</span>
    </button>
    <button class="btn-secondary" id="dl_btn" type="button" style="display:none;">
      Download PDF
    </button>
    <button class="btn-danger" id="cl_cancel_btn" style="display:none;">
      Cancel
    </button>
    <div style="margin-left:auto;font-family:var(--mono);font-size:11px;color:rgba(234,240,255,.45);letter-spacing:.08em;">
      STATUS <span id="action-status" style="color:rgba(251,191,36,.92);">IDLE</span>
    </div>
  </div>

  <div class="output-panel" style="margin-bottom:2rem;">
    <div class="tab-bar" role="tablist" aria-label="Cover letter output tabs">
      <div class="term-dots" aria-hidden="true">
        <div class="term-dot red"></div>
        <div class="term-dot amb"></div>
        <div class="term-dot grn"></div>
      </div>
      <button class="tab active" data-tab="pdf"  role="tab" aria-selected="true"  aria-controls="pane_pdf">PDF</button>
      <button class="tab"        data-tab="tex"  role="tab" aria-selected="false" aria-controls="pane_tex">LaTeX</button>
      <button class="tab"        data-tab="body" role="tab" aria-selected="false" aria-controls="pane_body">Body</button>
    </div>

    <div class="output-toolbar">
      <button class="btn-amber" id="cl_dl_pdf">Download PDF</button>
      <button class="btn-secondary" id="cl_dl_tex">Download .tex</button>
      <button class="btn-secondary" id="cl_copy_tex">Copy LaTeX</button>
    </div>

    <section id="pane_pdf" class="pane active" role="tabpanel">
      <iframe id="pdf_frame" class="pdf-frame" title="Cover Letter PDF" src="about:blank"></iframe>
    </section>
    <section id="pane_tex" class="pane" role="tabpanel" hidden>
      <pre id="cl-tex-output">// Waiting for generation…</pre>
    </section>
    <section id="pane_body" class="pane" role="tabpanel" hidden>
      <pre id="body_output">// Waiting for generation…</pre>
    </section>
  </div>

</main>

<footer>
  <span>© 2025 <b>HIREX</b> — <b>Sri Akash Kadali</b></span>
  <span>FastAPI · OpenAI · LaTeX</span>
  <span class="ver-tag">v1.0.0</span>
</footer>

<div id="toast" role="status" aria-live="polite"></div>
<button id="shutdown-fab" class="shutdown-fab" type="button" aria-label="Shutdown server">⏻</button>

<!-- Core utilities -->
<script src="/static/js/util.js?v=1.0.0" defer></script>
<script src="/static/js/ui.js?v=1.0.0" defer></script>
<!-- Cover letter functionality - handles fetching from backend -->
<script src="/static/js/coverletter.js?v=1.0.0" defer></script>

<script>
document.addEventListener("DOMContentLoaded", () => {
  /* ── Mini utils ── */
  const $ = (s, r = document) => r.querySelector(s);
  const $$ = (s, r = document) => [...r.querySelectorAll(s)];

  /* ── Clock ── */
  const clockEl = $("#sys-clock");
  const sessionEl = $("#session-id");
  if (sessionEl) sessionEl.textContent = Math.random().toString(36).slice(2, 8).toUpperCase();
  
  const tick = () => {
    if (clockEl) {
      const n = new Date();
      clockEl.textContent = n.toLocaleTimeString("en-GB", { hour12: false }) + " UTC";
    }
  };
  tick();
  setInterval(tick, 1000);

  /* ── Mobile nav toggle ── */
  const navToggle = $("#nav-toggle");
  navToggle?.addEventListener("click", () => {
    const on = !document.body.classList.contains("nav-open");
    document.body.classList.toggle("nav-open", on);
    navToggle.setAttribute("aria-expanded", String(on));
  });
  document.addEventListener("click", (e) => {
    const sb = $("#sidebar");
    if (document.body.classList.contains("nav-open") &&
        !sb?.contains(e.target) && !navToggle?.contains(e.target)) {
      document.body.classList.remove("nav-open");
      navToggle?.setAttribute("aria-expanded", "false");
    }
  });

  /* ── Tab switching ── */
  const tabs = $$(".tab");
  const panes = $$(".pane");
  
  tabs.forEach((tab) => {
    tab.addEventListener("click", () => {
      const target = tab.dataset.tab;
      
      // Update tabs
      tabs.forEach((t) => {
        t.classList.remove("active");
        t.setAttribute("aria-selected", "false");
      });
      tab.classList.add("active");
      tab.setAttribute("aria-selected", "true");
      
      // Update panes
      panes.forEach((p) => {
        p.classList.remove("active");
        p.hidden = true;
      });
      const targetPane = $(`#pane_${target}`);
      if (targetPane) {
        targetPane.classList.add("active");
        targetPane.hidden = false;
      }
    });
  });

  /* ── Sidebar generate button → main generate button ── */
  const sidebarGenBtn = $("#sidebar-gen-btn");
  const mainGenBtn = $("#generate_btn");
  sidebarGenBtn?.addEventListener("click", () => {
    mainGenBtn?.click();
  });

  /* ── Shutdown handlers ── */
  const shutdownBtn = $("#shutdown-btn");
  const shutdownFab = $("#shutdown-fab");
  
  const shutdownServer = async () => {
    if (!confirm("Are you sure you want to shutdown the server?")) return;
    
    try {
      const apiBase = window.HIREX?.getApiBase?.() || 
        (["127.0.0.1", "localhost"].includes(location.hostname) ? "http://127.0.0.1:8000" : location.origin);
      
      const res = await fetch(`${apiBase}/shutdown`, { method: "POST" });
      if (res.ok) {
        alert("Server is shutting down...");
      } else {
        alert("Failed to shutdown server");
      }
    } catch (e) {
      console.error("[HIREX] Shutdown error:", e);
      alert("Could not connect to server");
    }
  };
  
  shutdownBtn?.addEventListener("click", shutdownServer);
  shutdownFab?.addEventListener("click", shutdownServer);

  /* ── Status pill updates ── */
  const statusPill = $("#status-pill");
  const metaBadge = $("#meta_badge");
  const actionStatus = $("#action-status");
  
  window.HIREX = window.HIREX || {};
  window.HIREX.setStatus = (status, type = "idle") => {
    if (metaBadge) metaBadge.textContent = status;
    if (actionStatus) actionStatus.textContent = status.toUpperCase();
    
    if (statusPill) {
      statusPill.classList.remove("ready", "error");
      if (type === "ready" || type === "success") {
        statusPill.classList.add("ready");
      } else if (type === "error") {
        statusPill.classList.add("error");
      }
    }
  };

  /* ── Toast function ── */
  const toastEl = $("#toast");
  window.HIREX.toast = (msg, duration = 3000) => {
    if (!toastEl) {
      console.log(`[HIREX Toast] ${msg}`);
      return;
    }
    toastEl.textContent = msg;
    toastEl.style.display = "block";
    setTimeout(() => {
      toastEl.style.display = "none";
    }, duration);
  };

  /* ── Debug log ── */
  window.HIREX.debugLog = (msg, data) => {
    console.log(`[HIREX] ${msg}`, data || "");
  };

  /* ── API base ── */
  window.HIREX.getApiBase = () => {
    if (["127.0.0.1", "localhost"].includes(location.hostname)) {
      return "http://127.0.0.1:8000";
    }
    return location.origin;
  };

  console.log(
    "%c✉️ HIREX Cover Letter page loaded — v1.0.0",
    "background:#5bd0ff;color:#00131c;padding:4px 8px;border-radius:4px;font-weight:bold;"
  );
});
</script>
</body>
</html>